{"version":3,"sources":["webpack:///./src/views/participation/distribution/ParticipationManualDistribution.vue?1eb4","webpack:///src/views/participation/distribution/ParticipationManualDistribution.vue","webpack:///./src/views/participation/distribution/ParticipationManualDistribution.vue?427b","webpack:///./src/views/participation/distribution/ParticipationManualDistribution.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","attrs","_l","condition","index","key","conditionId","_s","name","arrayDataProxy","length","getConditionNames","moveToHandler","on","submitDistribution","staticRenderFns","props","components","ListParticipants","data","watch","participants","deep","immediate","handler","newArray","push","newValue","arrayData","computed","conditions","experiment","get","set","methods","getExposure","fetchExposures","experimentId","firstExposure","groupConditionList","map","undefined","conditionGroupIDMap","participantId","participant","consent","dropped","groupId","requestBody","temp","filteredParticipants","idx","beforeRouteEnter","beforeRouteUpdate","component","VBtn","VExpansionPanel","VExpansionPanelContent","VExpansionPanelHeader","VExpansionPanels"],"mappings":"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","file":"js/chunk-2d20950d.9f12091a.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',{staticClass:\"mb-5\"},[_vm._v(\" Select which students you would like for each condition. \")]),_c('p',[_vm._v(\"Conditions\")]),_c('v-expansion-panels',{staticClass:\"v-expansion-panels--icon\",attrs:{\"flat\":\"\"}},_vm._l((this.conditions),function(condition,index){return _c('v-expansion-panel',{key:condition.conditionId},[_c('v-expansion-panel-header',[_vm._v(\" \"+_vm._s(condition.name)+\" (\"+_vm._s(_vm.arrayDataProxy[index].length)+\") \")]),_c('v-expansion-panel-content',[_c('ListParticipants',{attrs:{\"listOfParticipants\":_vm.arrayDataProxy[index],\"moveToOptions\":_vm.getConditionNames,\"moveToHandler\":_vm.moveToHandler,\"selectedOption\":'' + index}})],1)],1)}),1),_c('ListParticipants',{attrs:{\"listOfParticipants\":_vm.arrayDataProxy[this.getConditionNames.length - 1],\"moveToOptions\":_vm.getConditionNames,\"moveToHandler\":_vm.moveToHandler,\"selectedOption\":'' + (this.getConditionNames.length - 1)}}),_c('v-btn',{staticClass:\"mt-10\",attrs:{\"elevation\":\"0\",\"color\":\"primary\"},on:{\"click\":_vm.submitDistribution}},[_vm._v(\"Continue\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <h1 class=\"mb-5\">\r\n      Select which students you would like for each condition.\r\n    </h1>\r\n\r\n    <!-- Conditions Section -->\r\n    <p>Conditions</p>\r\n    <v-expansion-panels class=\"v-expansion-panels--icon\" flat>\r\n      <v-expansion-panel\r\n        v-for=\"(condition, index) in this.conditions\"\r\n        :key=\"condition.conditionId\"\r\n      >\r\n        <v-expansion-panel-header>\r\n          {{ condition.name }} ({{ arrayDataProxy[index].length }})\r\n        </v-expansion-panel-header>\r\n        <v-expansion-panel-content>\r\n          <ListParticipants\r\n            :listOfParticipants=\"arrayDataProxy[index]\"\r\n            :moveToOptions=\"getConditionNames\"\r\n            :moveToHandler=\"moveToHandler\"\r\n            :selectedOption=\"'' + index\"\r\n          />\r\n        </v-expansion-panel-content>\r\n      </v-expansion-panel>\r\n    </v-expansion-panels>\r\n\r\n    <!-- Unassigned -->\r\n    <ListParticipants\r\n      :listOfParticipants=\"arrayDataProxy[this.getConditionNames.length - 1]\"\r\n      :moveToOptions=\"getConditionNames\"\r\n      :moveToHandler=\"moveToHandler\"\r\n      :selectedOption=\"'' + (this.getConditionNames.length - 1)\"\r\n    />\r\n\r\n    <v-btn\r\n      elevation=\"0\"\r\n      class=\"mt-10\"\r\n      color=\"primary\"\r\n      @click=\"submitDistribution\"\r\n      >Continue</v-btn\r\n    >\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport ListParticipants from '../../../components/ListParticipants.vue'\r\nimport store from '@/store'\r\nimport { mapGetters, mapActions } from 'vuex'\r\nimport { participantService } from '@/services'\r\n\r\nexport default {\r\n  name: 'ParticipationManualDistribution',\r\n  props: ['experiment'],\r\n  components: {\r\n    ListParticipants,\r\n  },\r\n  data() {\r\n    return {\r\n      arrayDataProxy: [],\r\n    };\r\n  },\r\n  watch: {\r\n    participants: {\r\n      // Watcher is required for keeping track of changes\r\n      // made in Participants\r\n      deep: true,\r\n      immediate: true,\r\n      handler(newValue) {\r\n        // This will only required when the page is loaded\r\n        const newArray = []\r\n        for (let i = 0; i < this.conditions.length; i++) {\r\n          newArray.push([])\r\n        }\r\n        // All the participant will go to 'Unparticipate' section\r\n        newArray.push(newValue)\r\n        this.arrayData = newArray\r\n      },\r\n    },\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      participants: 'participants/participants',\r\n      exposures: 'exposures/exposures',\r\n    }),\r\n\r\n    conditions() {\r\n      return this.experiment.conditions\r\n    },\r\n\r\n    getConditionNames() {\r\n      return [\r\n        ...this.experiment.conditions.map((condition) => condition.name),\r\n        'Unassigned',\r\n      ]\r\n    },\r\n\r\n    arrayData: {\r\n      get: function() {\r\n        const newArray = []\r\n        for (let i = 0; i < this.conditions.length; i++) {\r\n          newArray.push([])\r\n        }\r\n        // All the participant will go to 'Unparticipate' section\r\n        newArray.push(this.participants)\r\n        return newArray\r\n      },\r\n      set: function(newValue) {\r\n        this.arrayDataProxy = newValue\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    ...mapActions({\r\n      fetchExposures: 'exposures/fetchExposures'\r\n    }),\r\n\r\n    getExposure() {\r\n      this.fetchExposures(this.experiment.experimentId)\r\n    },\r\n\r\n    submitDistribution() {\r\n      const requestBody = []\r\n      const conditionGroupIDMap = {}\r\n\r\n      this.getExposure()\r\n      const firstExposureId = this.exposures\r\n        .map((expo) => expo.exposureId)\r\n        .sort((a, b) => a - b)[0]\r\n\r\n      const firstExposure = this.exposures.filter(\r\n        (expo) => expo.exposureId === firstExposureId\r\n      )[0]\r\n\r\n      firstExposure.groupConditionList.map(\r\n        ({ groupId }, index) => (conditionGroupIDMap[index] = groupId)\r\n      )\r\n\r\n      this.arrayDataProxy.map((arrData, index) =>\r\n        arrData.map((participant) => {\r\n          if (conditionGroupIDMap[index] !== undefined) {\r\n            const temp = {\r\n              participantId: participant.participantId,\r\n              consent: participant.consent,\r\n              dropped: participant.dropped,\r\n              groupId: conditionGroupIDMap[index],\r\n            }\r\n            requestBody.push(temp)\r\n          }\r\n        })\r\n      )\r\n\r\n      participantService\r\n        .updateParticipants(this.experiment.experimentId, requestBody)\r\n        .then((response) => {\r\n          if (response?.status === 200) {\r\n            this.$router.push({\r\n              name: 'ParticipationSummary',\r\n              params: { experiment: this.experiment.experimentId },\r\n            });\r\n          } else {\r\n            alert(response.error)\r\n          }\r\n        })\r\n        .catch((response) => {\r\n          console.log('submitParticipants | catch', { response });\r\n        })\r\n    },\r\n\r\n    moveToHandler(option, tempSelected) {\r\n      const selectedParticipantIDs = tempSelected.map(\r\n        (participant) => participant.participantId\r\n      )\r\n\r\n      const filteredParticipants = this.arrayDataProxy.map(\r\n        (conditionParticipantMap) =>\r\n          conditionParticipantMap.filter(\r\n            (participant) =>\r\n              !selectedParticipantIDs.includes(participant.participantId)\r\n          )\r\n      )\r\n\r\n      const idx = this.getConditionNames.indexOf(option)\r\n      filteredParticipants[idx] = [\r\n        ...filteredParticipants[idx],\r\n        ...tempSelected,\r\n      ]\r\n\r\n      this.arrayData = filteredParticipants\r\n    },\r\n  },\r\n  beforeRouteEnter(to, from, next) {\r\n    //  load participant data before selection screen\r\n    return (\r\n      store\r\n        .dispatch(\"participants/fetchParticipants\", to.params.experiment_id)\r\n        .then(next, next)\r\n    );\r\n  },\r\n  beforeRouteUpdate(to, from, next) {\r\n    //  load participant data before selection screen\r\n    return (\r\n      store\r\n        .dispatch(\"participants/fetchParticipants\", to.params.experiment_id)\r\n        .then(next, next)\r\n    );\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticipationManualDistribution.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParticipationManualDistribution.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ParticipationManualDistribution.vue?vue&type=template&id=db1829aa&\"\nimport script from \"./ParticipationManualDistribution.vue?vue&type=script&lang=js&\"\nexport * from \"./ParticipationManualDistribution.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VExpansionPanel } from 'vuetify/lib/components/VExpansionPanel';\nimport { VExpansionPanelContent } from 'vuetify/lib/components/VExpansionPanel';\nimport { VExpansionPanelHeader } from 'vuetify/lib/components/VExpansionPanel';\nimport { VExpansionPanels } from 'vuetify/lib/components/VExpansionPanel';\ninstallComponents(component, {VBtn,VExpansionPanel,VExpansionPanelContent,VExpansionPanelHeader,VExpansionPanels})\n"],"sourceRoot":""}